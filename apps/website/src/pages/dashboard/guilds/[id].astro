---
import { getGuild } from "~/lib/guilds";
import { isUserEligible } from "~/lib/user";

const { id } = Astro.params;

const user = Astro.locals.user;
if (!user || !id) {
  return Astro.redirect("/auth/login");
}

const guild = await getGuild(user, id, Astro.locals.runtime.env);
if (!guild) {
  return Astro.redirect("/dashboard");
}

const eligible = isUserEligible(guild);
if (!eligible) {
  return Astro.redirect("/dashboard");
}
---

You can manage guild {guild.name} with id {guild.id}
